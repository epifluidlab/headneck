See SF3.ipynb